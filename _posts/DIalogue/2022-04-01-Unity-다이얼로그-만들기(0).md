---
layout: post
title: Unity 다이얼로그 만들기(0)
date: 2022-04-01 02:45 +0900
modified: 2022-04-01 02:45:49 +09:00
description: 노드 방식 다이얼로그
tag:
  - Node-based dialogue
  - unity
  - dialogue
---
```
Unity 3.14f
```

### 0. 기존 다이얼로그 방식

<figure>
<img src="/assets/img/NodeBaseDialogue/0/0.png" alt="0">
<figcaption>이미지1</figcaption>
</figure>

<details>
<summary>기존 코드</summary>
{% gist d8a355230d7a0a1699680ded7e629abf %}
</details>

>기존 코드는 큐를 이용하여 다이얼로그의 문장을 받은 뒤 다음 문장을 이어나갑니다.

##### 발생하는 문제점
1. 대화창을 만들기 위해서 매번 트리거, 박스, 상호작용 컴포넌트등 붙여서 관리해야함  
-> 대화를 한 곳에서 관리하지 못함
2. 원하는 대화를 빠르게 삭제, 수정을 할 수 없음
3. 대화 작성에 시간 소비가 많아짐

##### 보완할 점
1. 특수 대화(모노로그)와 일반 대화를 구별
2. 대화에 따른 행동을 구별
3. 지금의 코드 상황으로는 스파게티 코드가 될 가능성이 매우 높음. 구조적으로 변경 필요

***

### 1. Base Code(Github)
<figure>
<img src="/assets/img/NodeBaseDialogue/1/0.png" alt="1">
<figcaption>이미지1</figcaption>
</figure>

<https://github.com/Wafflus/unity-dialogue-system/>

> 다이얼로그 코드는 위 repo를 사용했습니다.

***

### 2. Sample Usage

1. DialogueSystem 폴더 안 Script를 살펴보면 DS Dialogue 파일이 있다.
2. 이 파일을 컴포넌트로 추가해 다이얼로그 그래프에서 만든 스크립트 오브젝트를 불러와서 사용한다.
3. 해당 코드는 스크립트 오브젝트를 만드는 것만 있기 때문에 데이터 가공은 사용자의 몫

```
DS DialogueContainerSO : 다이얼로그 전체 데이터를 관리
DS DialogueGroupSO: 다이얼로그 데이터 중 그룹화된 항목 또는 비그룹 항목을 관리
DS DialogueSO: 다이얼로그 데이터 중 특정 다이얼로그 자체
```

> DEMO CODE
```C#
private IEnumerator Conversation(DSDialogueSO dialogueData)
{
	DSDialogueSO currentDialogue = dialogueData;
	while (currentDialogue != null)
	{
    Debug.Log(currentDialogue.Text);
    currentDialogue = currentDialogue.Choices[0].NextDialogue;
    yield return new WaitForSeconds(3f);
	}

	Debug.Log("Coroutine Stop");
}
```